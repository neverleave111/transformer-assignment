Device: cuda
Loading local IWSLT2017 from src/data/iwslt2017/en-de split=train
Prepared dataloader: 5000 examples, batch_size=32, seq_len=128
Parameter count (encoder + lm_head): 8646500
Epoch 1/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 1/10:   1%|          | 1/157 [00:00<01:03,  2.47it/s]Epoch 1/10:   4%|▍         | 7/157 [00:00<00:08, 16.89it/s]Epoch 1/10:   8%|▊         | 13/157 [00:00<00:05, 27.32it/s]Epoch 1/10:  12%|█▏        | 19/157 [00:00<00:03, 35.12it/s]Epoch 1/10:  12%|█▏        | 19/157 [00:00<00:03, 35.12it/s, loss=10.6125, lr=3.82e-05]Epoch 1/10:  16%|█▌        | 25/157 [00:00<00:03, 40.80it/s, loss=10.6125, lr=3.82e-05]Epoch 1/10:  20%|█▉        | 31/157 [00:00<00:02, 44.79it/s, loss=10.6125, lr=3.82e-05]Epoch 1/10:  24%|██▎       | 37/157 [00:01<00:02, 47.65it/s, loss=10.6125, lr=3.82e-05]Epoch 1/10:  24%|██▎       | 37/157 [00:01<00:02, 47.65it/s, loss=10.2929, lr=7.64e-05]Epoch 1/10:  27%|██▋       | 43/157 [00:01<00:02, 49.75it/s, loss=10.2929, lr=7.64e-05]Epoch 1/10:  31%|███       | 49/157 [00:01<00:02, 51.24it/s, loss=10.2929, lr=7.64e-05]Epoch 1/10:  35%|███▌      | 55/157 [00:01<00:01, 52.36it/s, loss=10.2929, lr=7.64e-05]Epoch 1/10:  35%|███▌      | 55/157 [00:01<00:01, 52.36it/s, loss=9.7111, lr=1.15e-04] Epoch 1/10:  39%|███▉      | 61/157 [00:01<00:01, 53.06it/s, loss=9.7111, lr=1.15e-04]Epoch 1/10:  43%|████▎     | 67/157 [00:01<00:01, 53.56it/s, loss=9.7111, lr=1.15e-04]Epoch 1/10:  46%|████▋     | 73/157 [00:01<00:01, 53.83it/s, loss=9.7111, lr=1.15e-04]Epoch 1/10:  50%|█████     | 79/157 [00:01<00:01, 54.19it/s, loss=9.7111, lr=1.15e-04]Epoch 1/10:  50%|█████     | 79/157 [00:01<00:01, 54.19it/s, loss=8.9525, lr=1.53e-04]Epoch 1/10:  54%|█████▍    | 85/157 [00:01<00:01, 54.47it/s, loss=8.9525, lr=1.53e-04]Epoch 1/10:  58%|█████▊    | 91/157 [00:02<00:01, 54.45it/s, loss=8.9525, lr=1.53e-04]Epoch 1/10:  62%|██████▏   | 97/157 [00:02<00:01, 54.59it/s, loss=8.9525, lr=1.53e-04]Epoch 1/10:  62%|██████▏   | 97/157 [00:02<00:01, 54.59it/s, loss=8.1433, lr=1.91e-04]Epoch 1/10:  66%|██████▌   | 103/157 [00:02<00:00, 54.69it/s, loss=8.1433, lr=1.91e-04]Epoch 1/10:  69%|██████▉   | 109/157 [00:02<00:00, 54.75it/s, loss=8.1433, lr=1.91e-04]Epoch 1/10:  73%|███████▎  | 115/157 [00:02<00:00, 54.89it/s, loss=8.1433, lr=1.91e-04]Epoch 1/10:  73%|███████▎  | 115/157 [00:02<00:00, 54.89it/s, loss=7.2515, lr=2.29e-04]Epoch 1/10:  77%|███████▋  | 121/157 [00:02<00:00, 54.89it/s, loss=7.2515, lr=2.29e-04]Epoch 1/10:  81%|████████  | 127/157 [00:02<00:00, 54.87it/s, loss=7.2515, lr=2.29e-04]Epoch 1/10:  85%|████████▍ | 133/157 [00:02<00:00, 54.73it/s, loss=7.2515, lr=2.29e-04]Epoch 1/10:  89%|████████▊ | 139/157 [00:02<00:00, 54.77it/s, loss=7.2515, lr=2.29e-04]Epoch 1/10:  89%|████████▊ | 139/157 [00:02<00:00, 54.77it/s, loss=6.3523, lr=2.68e-04]Epoch 1/10:  92%|█████████▏| 145/157 [00:03<00:00, 54.79it/s, loss=6.3523, lr=2.68e-04]Epoch 1/10:  96%|█████████▌| 151/157 [00:03<00:00, 54.86it/s, loss=6.3523, lr=2.68e-04]Epoch 1/10: 100%|██████████| 157/157 [00:03<00:00, 55.73it/s, loss=6.3523, lr=2.68e-04]                                                                                       Epoch 1 finished — epoch avg loss: 8.4121
Epoch 2/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 2/10:   0%|          | 0/157 [00:00<?, ?it/s, loss=5.2091, lr=2.99e-04]Epoch 2/10:   4%|▍         | 6/157 [00:00<00:02, 54.40it/s, loss=5.2091, lr=2.99e-04]Epoch 2/10:   8%|▊         | 12/157 [00:00<00:02, 54.44it/s, loss=5.2091, lr=2.99e-04]Epoch 2/10:  11%|█▏        | 18/157 [00:00<00:02, 54.53it/s, loss=5.2091, lr=2.99e-04]Epoch 2/10:  11%|█▏        | 18/157 [00:00<00:02, 54.53it/s, loss=4.7963, lr=2.95e-04]Epoch 2/10:  15%|█▌        | 24/157 [00:00<00:02, 54.50it/s, loss=4.7963, lr=2.95e-04]Epoch 2/10:  19%|█▉        | 30/157 [00:00<00:02, 54.40it/s, loss=4.7963, lr=2.95e-04]Epoch 2/10:  23%|██▎       | 36/157 [00:00<00:02, 54.48it/s, loss=4.7963, lr=2.95e-04]Epoch 2/10:  27%|██▋       | 42/157 [00:00<00:02, 54.48it/s, loss=4.7963, lr=2.95e-04]Epoch 2/10:  27%|██▋       | 42/157 [00:00<00:02, 54.48it/s, loss=4.2263, lr=2.91e-04]Epoch 2/10:  31%|███       | 48/157 [00:00<00:01, 54.56it/s, loss=4.2263, lr=2.91e-04]Epoch 2/10:  34%|███▍      | 54/157 [00:00<00:01, 54.21it/s, loss=4.2263, lr=2.91e-04]Epoch 2/10:  38%|███▊      | 60/157 [00:01<00:01, 54.40it/s, loss=4.2263, lr=2.91e-04]Epoch 2/10:  38%|███▊      | 60/157 [00:01<00:01, 54.40it/s, loss=3.8489, lr=2.87e-04]Epoch 2/10:  42%|████▏     | 66/157 [00:01<00:01, 54.38it/s, loss=3.8489, lr=2.87e-04]Epoch 2/10:  46%|████▌     | 72/157 [00:01<00:01, 54.42it/s, loss=3.8489, lr=2.87e-04]Epoch 2/10:  50%|████▉     | 78/157 [00:01<00:01, 54.57it/s, loss=3.8489, lr=2.87e-04]Epoch 2/10:  50%|████▉     | 78/157 [00:01<00:01, 54.57it/s, loss=3.5231, lr=2.82e-04]Epoch 2/10:  54%|█████▎    | 84/157 [00:01<00:01, 54.32it/s, loss=3.5231, lr=2.82e-04]Epoch 2/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.39it/s, loss=3.5231, lr=2.82e-04]Epoch 2/10:  61%|██████    | 96/157 [00:01<00:01, 54.59it/s, loss=3.5231, lr=2.82e-04]Epoch 2/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.73it/s, loss=3.5231, lr=2.82e-04]Epoch 2/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.73it/s, loss=3.2595, lr=2.78e-04]Epoch 2/10:  69%|██████▉   | 108/157 [00:01<00:00, 54.69it/s, loss=3.2595, lr=2.78e-04]Epoch 2/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.82it/s, loss=3.2595, lr=2.78e-04]Epoch 2/10:  76%|███████▋  | 120/157 [00:02<00:00, 55.01it/s, loss=3.2595, lr=2.78e-04]Epoch 2/10:  76%|███████▋  | 120/157 [00:02<00:00, 55.01it/s, loss=3.0593, lr=2.74e-04]Epoch 2/10:  80%|████████  | 126/157 [00:02<00:00, 54.92it/s, loss=3.0593, lr=2.74e-04]Epoch 2/10:  84%|████████▍ | 132/157 [00:02<00:00, 54.72it/s, loss=3.0593, lr=2.74e-04]Epoch 2/10:  88%|████████▊ | 138/157 [00:02<00:00, 54.69it/s, loss=3.0593, lr=2.74e-04]Epoch 2/10:  88%|████████▊ | 138/157 [00:02<00:00, 54.69it/s, loss=2.8747, lr=2.70e-04]Epoch 2/10:  92%|█████████▏| 144/157 [00:02<00:00, 54.67it/s, loss=2.8747, lr=2.70e-04]Epoch 2/10:  96%|█████████▌| 150/157 [00:02<00:00, 54.68it/s, loss=2.8747, lr=2.70e-04]Epoch 2/10:  99%|█████████▉| 156/157 [00:02<00:00, 54.72it/s, loss=2.8747, lr=2.70e-04]                                                                                       Epoch 2 finished — epoch avg loss: 3.5994
Epoch 3/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 3/10:   0%|          | 0/157 [00:00<?, ?it/s, loss=2.5596, lr=2.65e-04]Epoch 3/10:   4%|▍         | 6/157 [00:00<00:02, 54.77it/s, loss=2.5596, lr=2.65e-04]Epoch 3/10:   8%|▊         | 12/157 [00:00<00:02, 54.93it/s, loss=2.5596, lr=2.65e-04]Epoch 3/10:  11%|█▏        | 18/157 [00:00<00:02, 54.82it/s, loss=2.5596, lr=2.65e-04]Epoch 3/10:  15%|█▌        | 24/157 [00:00<00:02, 54.73it/s, loss=2.5596, lr=2.65e-04]Epoch 3/10:  15%|█▌        | 24/157 [00:00<00:02, 54.73it/s, loss=2.4800, lr=2.61e-04]Epoch 3/10:  19%|█▉        | 30/157 [00:00<00:02, 54.69it/s, loss=2.4800, lr=2.61e-04]Epoch 3/10:  23%|██▎       | 36/157 [00:00<00:02, 54.81it/s, loss=2.4800, lr=2.61e-04]Epoch 3/10:  27%|██▋       | 42/157 [00:00<00:02, 54.75it/s, loss=2.4800, lr=2.61e-04]Epoch 3/10:  27%|██▋       | 42/157 [00:00<00:02, 54.75it/s, loss=2.4102, lr=2.57e-04]Epoch 3/10:  31%|███       | 48/157 [00:00<00:01, 54.61it/s, loss=2.4102, lr=2.57e-04]Epoch 3/10:  34%|███▍      | 54/157 [00:00<00:01, 54.56it/s, loss=2.4102, lr=2.57e-04]Epoch 3/10:  38%|███▊      | 60/157 [00:01<00:01, 54.55it/s, loss=2.4102, lr=2.57e-04]Epoch 3/10:  38%|███▊      | 60/157 [00:01<00:01, 54.55it/s, loss=2.2851, lr=2.53e-04]Epoch 3/10:  42%|████▏     | 66/157 [00:01<00:01, 54.56it/s, loss=2.2851, lr=2.53e-04]Epoch 3/10:  46%|████▌     | 72/157 [00:01<00:01, 54.72it/s, loss=2.2851, lr=2.53e-04]Epoch 3/10:  50%|████▉     | 78/157 [00:01<00:01, 54.64it/s, loss=2.2851, lr=2.53e-04]Epoch 3/10:  54%|█████▎    | 84/157 [00:01<00:01, 54.66it/s, loss=2.2851, lr=2.53e-04]Epoch 3/10:  54%|█████▎    | 84/157 [00:01<00:01, 54.66it/s, loss=2.1626, lr=2.48e-04]Epoch 3/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.60it/s, loss=2.1626, lr=2.48e-04]Epoch 3/10:  61%|██████    | 96/157 [00:01<00:01, 54.70it/s, loss=2.1626, lr=2.48e-04]Epoch 3/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.93it/s, loss=2.1626, lr=2.48e-04]Epoch 3/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.93it/s, loss=2.0424, lr=2.44e-04]Epoch 3/10:  69%|██████▉   | 108/157 [00:01<00:00, 54.89it/s, loss=2.0424, lr=2.44e-04]Epoch 3/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.98it/s, loss=2.0424, lr=2.44e-04]Epoch 3/10:  76%|███████▋  | 120/157 [00:02<00:00, 55.06it/s, loss=2.0424, lr=2.44e-04]Epoch 3/10:  76%|███████▋  | 120/157 [00:02<00:00, 55.06it/s, loss=1.9627, lr=2.40e-04]Epoch 3/10:  80%|████████  | 126/157 [00:02<00:00, 54.99it/s, loss=1.9627, lr=2.40e-04]Epoch 3/10:  84%|████████▍ | 132/157 [00:02<00:00, 55.28it/s, loss=1.9627, lr=2.40e-04]Epoch 3/10:  88%|████████▊ | 138/157 [00:02<00:00, 55.31it/s, loss=1.9627, lr=2.40e-04]Epoch 3/10:  92%|█████████▏| 144/157 [00:02<00:00, 55.41it/s, loss=1.9627, lr=2.40e-04]Epoch 3/10:  92%|█████████▏| 144/157 [00:02<00:00, 55.41it/s, loss=1.9165, lr=2.36e-04]Epoch 3/10:  96%|█████████▌| 150/157 [00:02<00:00, 55.47it/s, loss=1.9165, lr=2.36e-04]Epoch 3/10:  99%|█████████▉| 156/157 [00:02<00:00, 55.49it/s, loss=1.9165, lr=2.36e-04]                                                                                       Epoch 3 finished — epoch avg loss: 2.1703
Epoch 4/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 4/10:   4%|▍         | 6/157 [00:00<00:02, 55.94it/s]Epoch 4/10:   4%|▍         | 6/157 [00:00<00:02, 55.94it/s, loss=1.7796, lr=2.31e-04]Epoch 4/10:   8%|▊         | 12/157 [00:00<00:02, 56.08it/s, loss=1.7796, lr=2.31e-04]Epoch 4/10:  11%|█▏        | 18/157 [00:00<00:02, 56.29it/s, loss=1.7796, lr=2.31e-04]Epoch 4/10:  15%|█▌        | 24/157 [00:00<00:02, 56.19it/s, loss=1.7796, lr=2.31e-04]Epoch 4/10:  15%|█▌        | 24/157 [00:00<00:02, 56.19it/s, loss=1.7726, lr=2.27e-04]Epoch 4/10:  19%|█▉        | 30/157 [00:00<00:02, 56.22it/s, loss=1.7726, lr=2.27e-04]Epoch 4/10:  23%|██▎       | 36/157 [00:00<00:02, 56.20it/s, loss=1.7726, lr=2.27e-04]Epoch 4/10:  27%|██▋       | 42/157 [00:00<00:02, 56.33it/s, loss=1.7726, lr=2.27e-04]Epoch 4/10:  31%|███       | 48/157 [00:00<00:01, 56.41it/s, loss=1.7726, lr=2.27e-04]Epoch 4/10:  31%|███       | 48/157 [00:00<00:01, 56.41it/s, loss=1.6182, lr=2.23e-04]Epoch 4/10:  34%|███▍      | 54/157 [00:00<00:01, 56.38it/s, loss=1.6182, lr=2.23e-04]Epoch 4/10:  38%|███▊      | 60/157 [00:01<00:01, 56.39it/s, loss=1.6182, lr=2.23e-04]Epoch 4/10:  42%|████▏     | 66/157 [00:01<00:01, 56.41it/s, loss=1.6182, lr=2.23e-04]Epoch 4/10:  42%|████▏     | 66/157 [00:01<00:01, 56.41it/s, loss=1.5702, lr=2.19e-04]Epoch 4/10:  46%|████▌     | 72/157 [00:01<00:01, 56.33it/s, loss=1.5702, lr=2.19e-04]Epoch 4/10:  50%|████▉     | 78/157 [00:01<00:01, 56.36it/s, loss=1.5702, lr=2.19e-04]Epoch 4/10:  54%|█████▎    | 84/157 [00:01<00:01, 56.39it/s, loss=1.5702, lr=2.19e-04]Epoch 4/10:  54%|█████▎    | 84/157 [00:01<00:01, 56.39it/s, loss=1.5320, lr=2.14e-04]Epoch 4/10:  57%|█████▋    | 90/157 [00:01<00:01, 56.43it/s, loss=1.5320, lr=2.14e-04]Epoch 4/10:  61%|██████    | 96/157 [00:01<00:01, 56.41it/s, loss=1.5320, lr=2.14e-04]Epoch 4/10:  65%|██████▍   | 102/157 [00:01<00:00, 56.45it/s, loss=1.5320, lr=2.14e-04]Epoch 4/10:  69%|██████▉   | 108/157 [00:01<00:00, 56.42it/s, loss=1.5320, lr=2.14e-04]Epoch 4/10:  69%|██████▉   | 108/157 [00:01<00:00, 56.42it/s, loss=1.4862, lr=2.10e-04]Epoch 4/10:  73%|███████▎  | 114/157 [00:02<00:00, 56.28it/s, loss=1.4862, lr=2.10e-04]Epoch 4/10:  76%|███████▋  | 120/157 [00:02<00:00, 56.28it/s, loss=1.4862, lr=2.10e-04]Epoch 4/10:  80%|████████  | 126/157 [00:02<00:00, 56.38it/s, loss=1.4862, lr=2.10e-04]Epoch 4/10:  80%|████████  | 126/157 [00:02<00:00, 56.38it/s, loss=1.4248, lr=2.06e-04]Epoch 4/10:  84%|████████▍ | 132/157 [00:02<00:00, 56.29it/s, loss=1.4248, lr=2.06e-04]Epoch 4/10:  88%|████████▊ | 138/157 [00:02<00:00, 56.36it/s, loss=1.4248, lr=2.06e-04]Epoch 4/10:  92%|█████████▏| 144/157 [00:02<00:00, 56.41it/s, loss=1.4248, lr=2.06e-04]Epoch 4/10:  92%|█████████▏| 144/157 [00:02<00:00, 56.41it/s, loss=1.4070, lr=2.02e-04]Epoch 4/10:  96%|█████████▌| 150/157 [00:02<00:00, 56.42it/s, loss=1.4070, lr=2.02e-04]Epoch 4/10:  99%|█████████▉| 156/157 [00:02<00:00, 56.43it/s, loss=1.4070, lr=2.02e-04]                                                                                       Epoch 4 finished — epoch avg loss: 1.5458
Epoch 5/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 5/10:   4%|▍         | 6/157 [00:00<00:02, 56.84it/s]Epoch 5/10:   4%|▍         | 6/157 [00:00<00:02, 56.84it/s, loss=1.2807, lr=1.97e-04]Epoch 5/10:   8%|▊         | 12/157 [00:00<00:02, 56.62it/s, loss=1.2807, lr=1.97e-04]Epoch 5/10:  11%|█▏        | 18/157 [00:00<00:02, 56.60it/s, loss=1.2807, lr=1.97e-04]Epoch 5/10:  15%|█▌        | 24/157 [00:00<00:02, 56.54it/s, loss=1.2807, lr=1.97e-04]Epoch 5/10:  19%|█▉        | 30/157 [00:00<00:02, 56.54it/s, loss=1.2807, lr=1.97e-04]Epoch 5/10:  19%|█▉        | 30/157 [00:00<00:02, 56.54it/s, loss=1.2723, lr=1.93e-04]Epoch 5/10:  23%|██▎       | 36/157 [00:00<00:02, 56.54it/s, loss=1.2723, lr=1.93e-04]Epoch 5/10:  27%|██▋       | 42/157 [00:00<00:02, 56.14it/s, loss=1.2723, lr=1.93e-04]Epoch 5/10:  31%|███       | 48/157 [00:00<00:01, 55.88it/s, loss=1.2723, lr=1.93e-04]Epoch 5/10:  31%|███       | 48/157 [00:00<00:01, 55.88it/s, loss=1.2264, lr=1.89e-04]Epoch 5/10:  34%|███▍      | 54/157 [00:00<00:01, 55.79it/s, loss=1.2264, lr=1.89e-04]Epoch 5/10:  38%|███▊      | 60/157 [00:01<00:01, 55.57it/s, loss=1.2264, lr=1.89e-04]Epoch 5/10:  42%|████▏     | 66/157 [00:01<00:01, 55.40it/s, loss=1.2264, lr=1.89e-04]Epoch 5/10:  42%|████▏     | 66/157 [00:01<00:01, 55.40it/s, loss=1.2434, lr=1.85e-04]Epoch 5/10:  46%|████▌     | 72/157 [00:01<00:01, 55.17it/s, loss=1.2434, lr=1.85e-04]Epoch 5/10:  50%|████▉     | 78/157 [00:01<00:01, 55.21it/s, loss=1.2434, lr=1.85e-04]Epoch 5/10:  54%|█████▎    | 84/157 [00:01<00:01, 55.06it/s, loss=1.2434, lr=1.85e-04]Epoch 5/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.83it/s, loss=1.2434, lr=1.85e-04]Epoch 5/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.83it/s, loss=1.1405, lr=1.80e-04]Epoch 5/10:  61%|██████    | 96/157 [00:01<00:01, 54.75it/s, loss=1.1405, lr=1.80e-04]Epoch 5/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.65it/s, loss=1.1405, lr=1.80e-04]Epoch 5/10:  69%|██████▉   | 108/157 [00:01<00:00, 54.61it/s, loss=1.1405, lr=1.80e-04]Epoch 5/10:  69%|██████▉   | 108/157 [00:02<00:00, 54.61it/s, loss=1.1857, lr=1.76e-04]Epoch 5/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.75it/s, loss=1.1857, lr=1.76e-04]Epoch 5/10:  76%|███████▋  | 120/157 [00:02<00:00, 54.71it/s, loss=1.1857, lr=1.76e-04]Epoch 5/10:  80%|████████  | 126/157 [00:02<00:00, 54.70it/s, loss=1.1857, lr=1.76e-04]Epoch 5/10:  80%|████████  | 126/157 [00:02<00:00, 54.70it/s, loss=1.1257, lr=1.72e-04]Epoch 5/10:  84%|████████▍ | 132/157 [00:02<00:00, 54.58it/s, loss=1.1257, lr=1.72e-04]Epoch 5/10:  88%|████████▊ | 138/157 [00:02<00:00, 54.45it/s, loss=1.1257, lr=1.72e-04]Epoch 5/10:  92%|█████████▏| 144/157 [00:02<00:00, 54.54it/s, loss=1.1257, lr=1.72e-04]Epoch 5/10:  96%|█████████▌| 150/157 [00:02<00:00, 54.69it/s, loss=1.1257, lr=1.72e-04]Epoch 5/10:  96%|█████████▌| 150/157 [00:02<00:00, 54.69it/s, loss=1.0921, lr=1.68e-04]Epoch 5/10:  99%|█████████▉| 156/157 [00:02<00:00, 54.62it/s, loss=1.0921, lr=1.68e-04]                                                                                       Epoch 5 finished — epoch avg loss: 1.1852
Epoch 6/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 6/10:   4%|▍         | 6/157 [00:00<00:02, 55.06it/s]Epoch 6/10:   8%|▊         | 12/157 [00:00<00:02, 54.93it/s]Epoch 6/10:   8%|▊         | 12/157 [00:00<00:02, 54.93it/s, loss=1.0399, lr=1.63e-04]Epoch 6/10:  11%|█▏        | 18/157 [00:00<00:02, 54.81it/s, loss=1.0399, lr=1.63e-04]Epoch 6/10:  15%|█▌        | 24/157 [00:00<00:02, 54.78it/s, loss=1.0399, lr=1.63e-04]Epoch 6/10:  19%|█▉        | 30/157 [00:00<00:02, 54.88it/s, loss=1.0399, lr=1.63e-04]Epoch 6/10:  19%|█▉        | 30/157 [00:00<00:02, 54.88it/s, loss=1.0149, lr=1.59e-04]Epoch 6/10:  23%|██▎       | 36/157 [00:00<00:02, 54.85it/s, loss=1.0149, lr=1.59e-04]Epoch 6/10:  27%|██▋       | 42/157 [00:00<00:02, 54.53it/s, loss=1.0149, lr=1.59e-04]Epoch 6/10:  31%|███       | 48/157 [00:00<00:01, 54.67it/s, loss=1.0149, lr=1.59e-04]Epoch 6/10:  34%|███▍      | 54/157 [00:00<00:01, 54.64it/s, loss=1.0149, lr=1.59e-04]Epoch 6/10:  34%|███▍      | 54/157 [00:01<00:01, 54.64it/s, loss=0.9691, lr=1.55e-04]Epoch 6/10:  38%|███▊      | 60/157 [00:01<00:01, 54.63it/s, loss=0.9691, lr=1.55e-04]Epoch 6/10:  42%|████▏     | 66/157 [00:01<00:01, 54.65it/s, loss=0.9691, lr=1.55e-04]Epoch 6/10:  46%|████▌     | 72/157 [00:01<00:01, 54.69it/s, loss=0.9691, lr=1.55e-04]Epoch 6/10:  46%|████▌     | 72/157 [00:01<00:01, 54.69it/s, loss=0.9785, lr=1.51e-04]Epoch 6/10:  50%|████▉     | 78/157 [00:01<00:01, 54.92it/s, loss=0.9785, lr=1.51e-04]Epoch 6/10:  54%|█████▎    | 84/157 [00:01<00:01, 54.98it/s, loss=0.9785, lr=1.51e-04]Epoch 6/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.92it/s, loss=0.9785, lr=1.51e-04]Epoch 6/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.92it/s, loss=0.9450, lr=1.46e-04]Epoch 6/10:  61%|██████    | 96/157 [00:01<00:01, 54.86it/s, loss=0.9450, lr=1.46e-04]Epoch 6/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.88it/s, loss=0.9450, lr=1.46e-04]Epoch 6/10:  69%|██████▉   | 108/157 [00:01<00:00, 54.94it/s, loss=0.9450, lr=1.46e-04]Epoch 6/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.85it/s, loss=0.9450, lr=1.46e-04]Epoch 6/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.85it/s, loss=0.9393, lr=1.42e-04]Epoch 6/10:  76%|███████▋  | 120/157 [00:02<00:00, 54.72it/s, loss=0.9393, lr=1.42e-04]Epoch 6/10:  80%|████████  | 126/157 [00:02<00:00, 54.69it/s, loss=0.9393, lr=1.42e-04]Epoch 6/10:  84%|████████▍ | 132/157 [00:02<00:00, 54.68it/s, loss=0.9393, lr=1.42e-04]Epoch 6/10:  84%|████████▍ | 132/157 [00:02<00:00, 54.68it/s, loss=0.9171, lr=1.38e-04]Epoch 6/10:  88%|████████▊ | 138/157 [00:02<00:00, 54.67it/s, loss=0.9171, lr=1.38e-04]Epoch 6/10:  92%|█████████▏| 144/157 [00:02<00:00, 54.83it/s, loss=0.9171, lr=1.38e-04]Epoch 6/10:  96%|█████████▌| 150/157 [00:02<00:00, 54.85it/s, loss=0.9171, lr=1.38e-04]Epoch 6/10:  96%|█████████▌| 150/157 [00:02<00:00, 54.85it/s, loss=0.9244, lr=1.34e-04]Epoch 6/10:  99%|█████████▉| 156/157 [00:02<00:00, 54.87it/s, loss=0.9244, lr=1.34e-04]                                                                                       Epoch 6 finished — epoch avg loss: 0.9629
Epoch 7/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 7/10:   4%|▍         | 6/157 [00:00<00:02, 54.83it/s]Epoch 7/10:   8%|▊         | 12/157 [00:00<00:02, 54.88it/s]Epoch 7/10:   8%|▊         | 12/157 [00:00<00:02, 54.88it/s, loss=0.8558, lr=1.30e-04]Epoch 7/10:  11%|█▏        | 18/157 [00:00<00:02, 54.78it/s, loss=0.8558, lr=1.30e-04]Epoch 7/10:  15%|█▌        | 24/157 [00:00<00:02, 54.75it/s, loss=0.8558, lr=1.30e-04]Epoch 7/10:  19%|█▉        | 30/157 [00:00<00:02, 54.50it/s, loss=0.8558, lr=1.30e-04]Epoch 7/10:  23%|██▎       | 36/157 [00:00<00:02, 54.43it/s, loss=0.8558, lr=1.30e-04]Epoch 7/10:  23%|██▎       | 36/157 [00:00<00:02, 54.43it/s, loss=0.8570, lr=1.25e-04]Epoch 7/10:  27%|██▋       | 42/157 [00:00<00:02, 54.69it/s, loss=0.8570, lr=1.25e-04]Epoch 7/10:  31%|███       | 48/157 [00:00<00:01, 54.70it/s, loss=0.8570, lr=1.25e-04]Epoch 7/10:  34%|███▍      | 54/157 [00:00<00:01, 54.67it/s, loss=0.8570, lr=1.25e-04]Epoch 7/10:  34%|███▍      | 54/157 [00:01<00:01, 54.67it/s, loss=0.8084, lr=1.21e-04]Epoch 7/10:  38%|███▊      | 60/157 [00:01<00:01, 54.62it/s, loss=0.8084, lr=1.21e-04]Epoch 7/10:  42%|████▏     | 66/157 [00:01<00:01, 54.67it/s, loss=0.8084, lr=1.21e-04]Epoch 7/10:  46%|████▌     | 72/157 [00:01<00:01, 54.71it/s, loss=0.8084, lr=1.21e-04]Epoch 7/10:  46%|████▌     | 72/157 [00:01<00:01, 54.71it/s, loss=0.8162, lr=1.17e-04]Epoch 7/10:  50%|████▉     | 78/157 [00:01<00:01, 54.72it/s, loss=0.8162, lr=1.17e-04]Epoch 7/10:  54%|█████▎    | 84/157 [00:01<00:01, 54.61it/s, loss=0.8162, lr=1.17e-04]Epoch 7/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.75it/s, loss=0.8162, lr=1.17e-04]Epoch 7/10:  61%|██████    | 96/157 [00:01<00:01, 54.58it/s, loss=0.8162, lr=1.17e-04]Epoch 7/10:  61%|██████    | 96/157 [00:01<00:01, 54.58it/s, loss=0.8309, lr=1.13e-04]Epoch 7/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.58it/s, loss=0.8309, lr=1.13e-04]Epoch 7/10:  69%|██████▉   | 108/157 [00:01<00:00, 54.61it/s, loss=0.8309, lr=1.13e-04]Epoch 7/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.59it/s, loss=0.8309, lr=1.13e-04]Epoch 7/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.59it/s, loss=0.7989, lr=1.08e-04]Epoch 7/10:  76%|███████▋  | 120/157 [00:02<00:00, 54.59it/s, loss=0.7989, lr=1.08e-04]Epoch 7/10:  80%|████████  | 126/157 [00:02<00:00, 54.56it/s, loss=0.7989, lr=1.08e-04]Epoch 7/10:  84%|████████▍ | 132/157 [00:02<00:00, 54.64it/s, loss=0.7989, lr=1.08e-04]Epoch 7/10:  84%|████████▍ | 132/157 [00:02<00:00, 54.64it/s, loss=0.8048, lr=1.04e-04]Epoch 7/10:  88%|████████▊ | 138/157 [00:02<00:00, 54.61it/s, loss=0.8048, lr=1.04e-04]Epoch 7/10:  92%|█████████▏| 144/157 [00:02<00:00, 54.57it/s, loss=0.8048, lr=1.04e-04]Epoch 7/10:  96%|█████████▌| 150/157 [00:02<00:00, 54.57it/s, loss=0.8048, lr=1.04e-04]Epoch 7/10:  99%|█████████▉| 156/157 [00:02<00:00, 54.53it/s, loss=0.8048, lr=1.04e-04]                                                                                       Epoch 7 finished — epoch avg loss: 0.8213
Epoch 8/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 8/10:   0%|          | 0/157 [00:00<?, ?it/s, loss=0.7988, lr=9.98e-05]Epoch 8/10:   4%|▍         | 6/157 [00:00<00:02, 54.79it/s, loss=0.7988, lr=9.98e-05]Epoch 8/10:   8%|▊         | 12/157 [00:00<00:02, 54.72it/s, loss=0.7988, lr=9.98e-05]Epoch 8/10:  11%|█▏        | 18/157 [00:00<00:02, 54.63it/s, loss=0.7988, lr=9.98e-05]Epoch 8/10:  11%|█▏        | 18/157 [00:00<00:02, 54.63it/s, loss=0.7669, lr=9.55e-05]Epoch 8/10:  15%|█▌        | 24/157 [00:00<00:02, 54.64it/s, loss=0.7669, lr=9.55e-05]Epoch 8/10:  19%|█▉        | 30/157 [00:00<00:02, 54.78it/s, loss=0.7669, lr=9.55e-05]Epoch 8/10:  23%|██▎       | 36/157 [00:00<00:02, 54.78it/s, loss=0.7669, lr=9.55e-05]Epoch 8/10:  23%|██▎       | 36/157 [00:00<00:02, 54.78it/s, loss=0.7535, lr=9.13e-05]Epoch 8/10:  27%|██▋       | 42/157 [00:00<00:02, 54.72it/s, loss=0.7535, lr=9.13e-05]Epoch 8/10:  31%|███       | 48/157 [00:00<00:01, 54.63it/s, loss=0.7535, lr=9.13e-05]Epoch 8/10:  34%|███▍      | 54/157 [00:00<00:01, 54.68it/s, loss=0.7535, lr=9.13e-05]Epoch 8/10:  38%|███▊      | 60/157 [00:01<00:01, 54.89it/s, loss=0.7535, lr=9.13e-05]Epoch 8/10:  38%|███▊      | 60/157 [00:01<00:01, 54.89it/s, loss=0.7216, lr=8.70e-05]Epoch 8/10:  42%|████▏     | 66/157 [00:01<00:01, 54.83it/s, loss=0.7216, lr=8.70e-05]Epoch 8/10:  46%|████▌     | 72/157 [00:01<00:01, 54.80it/s, loss=0.7216, lr=8.70e-05]Epoch 8/10:  50%|████▉     | 78/157 [00:01<00:01, 54.69it/s, loss=0.7216, lr=8.70e-05]Epoch 8/10:  50%|████▉     | 78/157 [00:01<00:01, 54.69it/s, loss=0.7259, lr=8.28e-05]Epoch 8/10:  54%|█████▎    | 84/157 [00:01<00:01, 54.86it/s, loss=0.7259, lr=8.28e-05]Epoch 8/10:  57%|█████▋    | 90/157 [00:01<00:01, 54.90it/s, loss=0.7259, lr=8.28e-05]Epoch 8/10:  61%|██████    | 96/157 [00:01<00:01, 54.83it/s, loss=0.7259, lr=8.28e-05]Epoch 8/10:  61%|██████    | 96/157 [00:01<00:01, 54.83it/s, loss=0.7430, lr=7.86e-05]Epoch 8/10:  65%|██████▍   | 102/157 [00:01<00:01, 54.82it/s, loss=0.7430, lr=7.86e-05]Epoch 8/10:  69%|██████▉   | 108/157 [00:01<00:00, 54.83it/s, loss=0.7430, lr=7.86e-05]Epoch 8/10:  73%|███████▎  | 114/157 [00:02<00:00, 54.78it/s, loss=0.7430, lr=7.86e-05]Epoch 8/10:  76%|███████▋  | 120/157 [00:02<00:00, 54.76it/s, loss=0.7430, lr=7.86e-05]Epoch 8/10:  76%|███████▋  | 120/157 [00:02<00:00, 54.76it/s, loss=0.7040, lr=7.43e-05]Epoch 8/10:  80%|████████  | 126/157 [00:02<00:00, 54.66it/s, loss=0.7040, lr=7.43e-05]Epoch 8/10:  84%|████████▍ | 132/157 [00:02<00:00, 54.77it/s, loss=0.7040, lr=7.43e-05]Epoch 8/10:  88%|████████▊ | 138/157 [00:02<00:00, 54.82it/s, loss=0.7040, lr=7.43e-05]Epoch 8/10:  88%|████████▊ | 138/157 [00:02<00:00, 54.82it/s, loss=0.6807, lr=7.01e-05]Epoch 8/10:  92%|█████████▏| 144/157 [00:02<00:00, 54.80it/s, loss=0.6807, lr=7.01e-05]Epoch 8/10:  96%|█████████▌| 150/157 [00:02<00:00, 54.80it/s, loss=0.6807, lr=7.01e-05]Epoch 8/10:  99%|█████████▉| 156/157 [00:02<00:00, 55.10it/s, loss=0.6807, lr=7.01e-05]                                                                                       Epoch 8 finished — epoch avg loss: 0.7270
Epoch 9/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 9/10:   0%|          | 0/157 [00:00<?, ?it/s, loss=0.6482, lr=6.58e-05]Epoch 9/10:   4%|▍         | 6/157 [00:00<00:02, 56.45it/s, loss=0.6482, lr=6.58e-05]Epoch 9/10:   8%|▊         | 12/157 [00:00<00:02, 56.50it/s, loss=0.6482, lr=6.58e-05]Epoch 9/10:  11%|█▏        | 18/157 [00:00<00:02, 56.52it/s, loss=0.6482, lr=6.58e-05]Epoch 9/10:  11%|█▏        | 18/157 [00:00<00:02, 56.52it/s, loss=0.6810, lr=6.16e-05]Epoch 9/10:  15%|█▌        | 24/157 [00:00<00:02, 56.51it/s, loss=0.6810, lr=6.16e-05]Epoch 9/10:  19%|█▉        | 30/157 [00:00<00:02, 56.43it/s, loss=0.6810, lr=6.16e-05]Epoch 9/10:  23%|██▎       | 36/157 [00:00<00:02, 56.40it/s, loss=0.6810, lr=6.16e-05]Epoch 9/10:  27%|██▋       | 42/157 [00:00<00:02, 56.40it/s, loss=0.6810, lr=6.16e-05]Epoch 9/10:  27%|██▋       | 42/157 [00:00<00:02, 56.40it/s, loss=0.6739, lr=5.73e-05]Epoch 9/10:  31%|███       | 48/157 [00:00<00:01, 56.32it/s, loss=0.6739, lr=5.73e-05]Epoch 9/10:  34%|███▍      | 54/157 [00:00<00:01, 56.42it/s, loss=0.6739, lr=5.73e-05]Epoch 9/10:  38%|███▊      | 60/157 [00:01<00:01, 56.39it/s, loss=0.6739, lr=5.73e-05]Epoch 9/10:  38%|███▊      | 60/157 [00:01<00:01, 56.39it/s, loss=0.6875, lr=5.31e-05]Epoch 9/10:  42%|████▏     | 66/157 [00:01<00:01, 56.36it/s, loss=0.6875, lr=5.31e-05]Epoch 9/10:  46%|████▌     | 72/157 [00:01<00:01, 56.36it/s, loss=0.6875, lr=5.31e-05]Epoch 9/10:  50%|████▉     | 78/157 [00:01<00:01, 56.35it/s, loss=0.6875, lr=5.31e-05]Epoch 9/10:  50%|████▉     | 78/157 [00:01<00:01, 56.35it/s, loss=0.6531, lr=4.88e-05]Epoch 9/10:  54%|█████▎    | 84/157 [00:01<00:01, 56.30it/s, loss=0.6531, lr=4.88e-05]Epoch 9/10:  57%|█████▋    | 90/157 [00:01<00:01, 56.35it/s, loss=0.6531, lr=4.88e-05]Epoch 9/10:  61%|██████    | 96/157 [00:01<00:01, 56.48it/s, loss=0.6531, lr=4.88e-05]Epoch 9/10:  65%|██████▍   | 102/157 [00:01<00:00, 56.43it/s, loss=0.6531, lr=4.88e-05]Epoch 9/10:  65%|██████▍   | 102/157 [00:01<00:00, 56.43it/s, loss=0.6630, lr=4.46e-05]Epoch 9/10:  69%|██████▉   | 108/157 [00:01<00:00, 56.32it/s, loss=0.6630, lr=4.46e-05]Epoch 9/10:  73%|███████▎  | 114/157 [00:02<00:00, 56.44it/s, loss=0.6630, lr=4.46e-05]Epoch 9/10:  76%|███████▋  | 120/157 [00:02<00:00, 56.38it/s, loss=0.6630, lr=4.46e-05]Epoch 9/10:  76%|███████▋  | 120/157 [00:02<00:00, 56.38it/s, loss=0.6661, lr=4.03e-05]Epoch 9/10:  80%|████████  | 126/157 [00:02<00:00, 56.38it/s, loss=0.6661, lr=4.03e-05]Epoch 9/10:  84%|████████▍ | 132/157 [00:02<00:00, 56.44it/s, loss=0.6661, lr=4.03e-05]Epoch 9/10:  88%|████████▊ | 138/157 [00:02<00:00, 56.40it/s, loss=0.6661, lr=4.03e-05]Epoch 9/10:  88%|████████▊ | 138/157 [00:02<00:00, 56.40it/s, loss=0.6763, lr=3.61e-05]Epoch 9/10:  92%|█████████▏| 144/157 [00:02<00:00, 56.34it/s, loss=0.6763, lr=3.61e-05]Epoch 9/10:  96%|█████████▌| 150/157 [00:02<00:00, 56.41it/s, loss=0.6763, lr=3.61e-05]Epoch 9/10:  99%|█████████▉| 156/157 [00:02<00:00, 56.57it/s, loss=0.6763, lr=3.61e-05]                                                                                       Epoch 9 finished — epoch avg loss: 0.6704
Epoch 10/10:   0%|          | 0/157 [00:00<?, ?it/s]Epoch 10/10:   4%|▍         | 6/157 [00:00<00:02, 56.55it/s]Epoch 10/10:   4%|▍         | 6/157 [00:00<00:02, 56.55it/s, loss=0.6612, lr=3.18e-05]Epoch 10/10:   8%|▊         | 12/157 [00:00<00:02, 56.42it/s, loss=0.6612, lr=3.18e-05]Epoch 10/10:  11%|█▏        | 18/157 [00:00<00:02, 56.39it/s, loss=0.6612, lr=3.18e-05]Epoch 10/10:  15%|█▌        | 24/157 [00:00<00:02, 56.42it/s, loss=0.6612, lr=3.18e-05]Epoch 10/10:  15%|█▌        | 24/157 [00:00<00:02, 56.42it/s, loss=0.6569, lr=2.76e-05]Epoch 10/10:  19%|█▉        | 30/157 [00:00<00:02, 56.38it/s, loss=0.6569, lr=2.76e-05]Epoch 10/10:  23%|██▎       | 36/157 [00:00<00:02, 56.41it/s, loss=0.6569, lr=2.76e-05]Epoch 10/10:  27%|██▋       | 42/157 [00:00<00:02, 56.36it/s, loss=0.6569, lr=2.76e-05]Epoch 10/10:  27%|██▋       | 42/157 [00:00<00:02, 56.36it/s, loss=0.6479, lr=2.34e-05]Epoch 10/10:  31%|███       | 48/157 [00:00<00:01, 56.31it/s, loss=0.6479, lr=2.34e-05]Epoch 10/10:  34%|███▍      | 54/157 [00:00<00:01, 56.30it/s, loss=0.6479, lr=2.34e-05]Epoch 10/10:  38%|███▊      | 60/157 [00:01<00:01, 56.33it/s, loss=0.6479, lr=2.34e-05]Epoch 10/10:  42%|████▏     | 66/157 [00:01<00:01, 56.13it/s, loss=0.6479, lr=2.34e-05]Epoch 10/10:  42%|████▏     | 66/157 [00:01<00:01, 56.13it/s, loss=0.6564, lr=1.91e-05]Epoch 10/10:  46%|████▌     | 72/157 [00:01<00:01, 56.14it/s, loss=0.6564, lr=1.91e-05]Epoch 10/10:  50%|████▉     | 78/157 [00:01<00:01, 56.13it/s, loss=0.6564, lr=1.91e-05]Epoch 10/10:  54%|█████▎    | 84/157 [00:01<00:01, 56.21it/s, loss=0.6564, lr=1.91e-05]Epoch 10/10:  54%|█████▎    | 84/157 [00:01<00:01, 56.21it/s, loss=0.6619, lr=1.49e-05]Epoch 10/10:  57%|█████▋    | 90/157 [00:01<00:01, 56.18it/s, loss=0.6619, lr=1.49e-05]Epoch 10/10:  61%|██████    | 96/157 [00:01<00:01, 56.19it/s, loss=0.6619, lr=1.49e-05]Epoch 10/10:  65%|██████▍   | 102/157 [00:01<00:00, 56.26it/s, loss=0.6619, lr=1.49e-05]Epoch 10/10:  65%|██████▍   | 102/157 [00:01<00:00, 56.26it/s, loss=0.6382, lr=1.06e-05]Epoch 10/10:  69%|██████▉   | 108/157 [00:01<00:00, 56.29it/s, loss=0.6382, lr=1.06e-05]Epoch 10/10:  73%|███████▎  | 114/157 [00:02<00:00, 56.27it/s, loss=0.6382, lr=1.06e-05]Epoch 10/10:  76%|███████▋  | 120/157 [00:02<00:00, 56.31it/s, loss=0.6382, lr=1.06e-05]Epoch 10/10:  80%|████████  | 126/157 [00:02<00:00, 56.33it/s, loss=0.6382, lr=1.06e-05]Epoch 10/10:  80%|████████  | 126/157 [00:02<00:00, 56.33it/s, loss=0.6065, lr=6.37e-06]Epoch 10/10:  84%|████████▍ | 132/157 [00:02<00:00, 56.31it/s, loss=0.6065, lr=6.37e-06]Epoch 10/10:  88%|████████▊ | 138/157 [00:02<00:00, 56.34it/s, loss=0.6065, lr=6.37e-06]Epoch 10/10:  92%|█████████▏| 144/157 [00:02<00:00, 56.28it/s, loss=0.6065, lr=6.37e-06]Epoch 10/10:  92%|█████████▏| 144/157 [00:02<00:00, 56.28it/s, loss=0.6433, lr=2.12e-06]Epoch 10/10:  96%|█████████▌| 150/157 [00:02<00:00, 56.29it/s, loss=0.6433, lr=2.12e-06]Epoch 10/10:  99%|█████████▉| 156/157 [00:02<00:00, 56.42it/s, loss=0.6433, lr=2.12e-06]                                                                                        Epoch 10 finished — epoch avg loss: 0.6454
Saved curve to results/ablation/iwslt_encoderonly/train_curve.png
